# Project-L
**Суть проекта - распознавать движение руки в виде трясущейся буквы L.** Данный проект был реализован для применения методов компьютерного зрения и ознакомления с **STGCN (spatial-temporal graph convolutional network)**. Сам результат не несет практической пользы. Распозновать трясущуюся букву L было выбрано целью _из-за простоты создания набора данных_ (он был создан вручную) и _просто ради забавы_.

---

### Используемый пайплайн и файлы проекта

В проекте используется следующий пайплайн:

1. mediapipe (модель для распознавания графа руки) достает нормализованные координаты
2. полученные точки сохраняются в буфер _длиною в 30 кадров_
3. каждые _5 кадров_ буфер отправляется на инференс в обученный STGCN.

В данном проекте есть следующие файлы отвечающие каждый за свое:

- **camera.py** - файл для записи датасета
- **STGCN.py** - файл с реализацией STGCN
- **main.ipynb** - этот ноутбук для обучения и оценки модели
- **model_inference.py** - файл для инференса модели
- **.pth файлы** - сохраненные модели и их результаты
- **nums.txt** - файл для сбора датасета

---

### Установка
1. Клонируем репозиторий и переходим в папку с проектом:

```
https://github.com/UraniumSlashBroomer/Project-L.git
cd Project-L
```

2. Создаем виртуальную среду, активируем и устанавливаем зависимости:
```
virtualenv .env
source .env/bin/activate
pip install -r requirements.txt
```

**ВАЖНО!**
В requirements находится torch без поддержки GPU. Это связано с тем, что torch с поддержкой GPU занимает 7 ГБ места, а без всего 1 ГБ. **Если нужно обучить модель - установите torch с поддержкой GPU (CUDA 12.6)** вручную следующей командой:
```
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu126
```

---

### Просмотр main.ipynb ноутбука

Запустите jupyter notebook в активированной среде с помощью команды:
```
jupyter notebook
```

---

### Запуск модели
Инференс модели находится в файле model_inference.py. 

**ВАЖНО!**
**Чтобы закрыть окно с камерой нажмите ESC**

Каждые 5 кадров в консоль на данный момент выводится следущее:

_(вероятность принадлежности к классу 0, вероятность принадлежности к классу 1)_
_итоговый ответ модели_

Пример:
---
![2025-10-03 20-52-06_1](https://github.com/user-attachments/assets/6a083634-13d6-4db6-a8aa-3699d950e181)

